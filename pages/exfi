<template>
    <!-- Main card containing the entire component -->
    <div>
        <v-card class="mx-auto text-center mx-2" color="#ffff00" dark>
            <!-- Sidebar column with menu and buttons -->
            <v-row>
                <v-col cols="2" class="py-0 pl-2 pr-0">
                    <!-- Card for menu and subheader -->
                    <v-card class="mx-auto pb-4" max-width="300" tile>
                        <!-- Subheader with TABLE | GRAPH text -->
                        <v-subheader style="color: #ffff00;">TABLE | GRAPH</v-subheader>
                        <!-- Dropdown menu for table selection -->
                        <v-menu flat transition="slide-x-transition" bottom right>
                            <template v-slot:activator="{ on, attrs }">
                                <!-- Button to activate the menu -->
                                <v-btn style=" width: 99%; border-radius: 0%; background-color: #ffff00; color: #000;" dark
                                    v-bind="attrs" v-on="on">
                                    MENU TABLES
                                    <v-icon>mdi-table-sync</v-icon>
                                </v-btn>
                            </template>
                            <!-- List of table options in the menu -->
                            <v-list flat class="pt-0" style="background-color: #ffffe6;">
                                <!-- ... (List items for different tables) -->
                                <v-card-text class="text-center" style="background-color:#000; color: #ffff00;">
                                    <h3>TABLE</h3>
                                </v-card-text>
                                <v-divider style="background-color: #000;" />
                                <v-list-item v-for="(item, indexA) in menuItems" :key="indexA" class="ma-0 py-0 pl-0 pr-2"
                                    style="width: 100%;" :disabled="(tabledisplay === 'Targets' && indexA === 3)"
                                    @click="changeGraph(item.name)" @mouseenter="expand = `btn-${indexA + 1}`"
                                    @mouseleave="expand = ''">
                                    <v-btn class="px-2" text
                                        style="width: 100%; color:#000; border-top-right-radius: 50px; border-bottom-right-radius: 50px;"
                                        :style="{ backgroundColor: expand === `btn-${indexA + 1}` ? 'rgb(255, 255, 0)' : '#ffffe6' }">
                                        {{ item.label }}
                                    </v-btn>
                                </v-list-item>
                            </v-list>
                        </v-menu>
                    </v-card>
                    <v-divider style="background-color: #ffff00;"></v-divider>
                    <!-- Cards for different tables based on selection -->
                    <v-card v-if="tabledisplay === 'Customer Complaint'" class="mx-auto" max-width="300" tile>
                        <!-- ... (Content for Customer Complaint table) -->
                        <v-list shaped>
                            <v-subheader style="color: #ffff00;">{{ tabledisplay }}</v-subheader>
                            <v-list-item-group v-model="selectedItem" color="yellow">
                                <v-list-item v-for="(item, i) in itemdatacustomer" :key="i"
                                    @click="changeGraph('Customer Complaint')">
                                    <v-list-item-content>
                                        <v-list-item-title>
                                            {{ item.text }}
                                        </v-list-item-title>
                                    </v-list-item-content>
                                </v-list-item>
                            </v-list-item-group>
                        </v-list>
                    </v-card>
                    <v-card v-if="tabledisplay === 'Root Cause'" class="mx-auto" max-width="300" tile>
                        <!-- ... (Content for Root Cause table) -->
                        <v-list shaped>
                            <v-subheader style="color: #ffff00;">{{ tabledisplay }}</v-subheader>
                            <v-list-item-group v-model="selectedItem" color="yellow">
                                <!-- Use v-if on the v-list-item to conditionally render it -->
                                <v-list-item v-for="(item, i) in itemdatacust" :key="i" @click="changeGraph('Root Cause')">
                                    <v-list-item-content>
                                        <v-list-item-title>
                                            {{ item.text }}
                                        </v-list-item-title>
                                    </v-list-item-content>
                                </v-list-item>
                            </v-list-item-group>
                        </v-list>
                    </v-card>
                    <v-card v-if="tabledisplay === 'Root Cause Report'" class="mx-auto" max-width="300" tile>
                        <!-- ... (Content for Root Cause Report table) -->
                        <v-list shaped>
                            <v-subheader style="color: #ffff00;">{{ tabledisplay }}</v-subheader>
                            <v-list-item-group v-model="selectedItem" color="yellow">
                                <v-list-item v-for="(item, i) in itemdatarootall" :key="i"
                                    @click="changeGraph('Root Cause Report')">
                                    <v-list-item-content>
                                        <v-list-item-title>
                                            {{ item.text }}
                                        </v-list-item-title>
                                    </v-list-item-content>
                                </v-list-item>
                            </v-list-item-group>
                        </v-list>
                    </v-card>
                    <div v-if="this.tabledisplay !== 'Targets'">
                        <!-- Section for styling the graph -->
                        <!-- ... (Buttons for styling the graph) -->
                        <v-card-text class="mt-2" style="color: #000;">
                            <h4>STYLE GRAPH</h4>
                        </v-card-text>
                        <v-divider style="background-color: #000;" />
                        <v-col cols="12" sm="12" md="12" class="mt-4 by-4 px-2">
                            <v-item-group mandatory>
                                <v-row class="fill-height">
                                    <v-col v-for="(item, i) in itemsbuton" :key="i" class="px-1 pt-1">
                                        <v-item v-slot="{ active, toggle }">
                                            <v-btn text class="pa-2"
                                                style="background-color: transparent; color: transparent;"
                                                @click="showgraph(item.name)">
                                                <v-card flat :style="{
                                                    background: graphstyle[0],
                                                    border: '2px solid',
                                                    borderColor: active ? '#000' : 'white'
                                                }" class="text-center pa-1" @click="toggle">
                                                    <v-icon size="35"
                                                        :style="{ color: graphform === item.name ? '#000' : '#fff' }">{{
                                                            item.icon
                                                        }}</v-icon>
                                                </v-card>
                                            </v-btn>
                                        </v-item>
                                    </v-col>
                                </v-row>
                            </v-item-group>
                        </v-col>
                    </div>
                    <div v-else>
                        <v-card flat class="rounded-0" style="background-color: #ffffe6;">
                            <v-card-text class="pa-0" style="background-color:#000;color:#ffff00">
                                <v-row>
                                    <v-col cols="6" class="pr-0 pt-0">
                                        <v-card-text class="mb-1 pa-0" style=" background-color: #ffff00;">
                                            <v-btn class="py-2 rounded-0" text
                                                style="width: 100%; height: 100%; color: #000;" @click="targetDate = true">
                                                <span style="color: #000;">
                                                    dates
                                                </span>
                                            </v-btn>
                                        </v-card-text>
                                    </v-col>
                                    <v-col cols="6" class="pl-1 pt-0" style="padding-right: 13px;">
                                        <v-card-text class="pa-0 mb-1" style="color: #000; background-color: #ffff00;">
                                            <v-btn class="py-2 rounded-0" text
                                                style="width: 100%; height: 100%; color: #000;" @click="targetDate = false">
                                                service
                                            </v-btn>
                                        </v-card-text>
                                    </v-col>
                                </v-row>
                                <v-divider style="background-color: #000;"></v-divider>
                            </v-card-text>
                            <v-card-text class="px-2 py-1" style="color: #000;">
                                <div>
                                    <h4>
                                        Time Do Tplus
                                    </h4>
                                    <div>
                                        <v-card-actions class="pa-0">
                                            <p class="px-2 rounded-6"
                                                :style="{ backgroundColor: checkTargetDo === 'Achieved the Target' ? 'rgb(198, 255, 179)' : 'rgb(255, 214, 204)' }">
                                                {{
                                                    checkTargetDo }}</p>
                                            <v-spacer></v-spacer>
                                            <v-icon v-if="checkTargetDo === 'Achieved the Target'"
                                                color="rgb(0, 230, 0)">mdi-checkbox-marked</v-icon>
                                            <v-icon v-else color="error">mdi-close-box</v-icon>
                                        </v-card-actions>
                                        <h3
                                            :style="{ color: checkTargetDo === 'Achieved the Target' ? 'rgb(0, 230, 0)' : 'rgb(255, 71, 26)' }">
                                            {{ percentTimeDoTa }}
                                        </h3>
                                    </div>
                                </div>
                                <v-divider style="background-color: #ffff00;"></v-divider>
                                <div>
                                    <h4>
                                        Time Care Tplus
                                    </h4>
                                    <div>
                                        <v-card-actions class="pa-0">
                                            <p class="px-2"
                                                :style="{ backgroundColor: checkTargetCare === 'Achieved the Target' ? 'rgb(198, 255, 179)' : 'rgb(255, 214, 204)' }">
                                                {{ checkTargetCare }}</p>
                                            <v-spacer></v-spacer>
                                            <v-icon v-if="checkTargetCare === 'Achieved the Target'"
                                                color="rgb(0, 230, 0)">mdi-checkbox-marked</v-icon>
                                            <v-icon v-else color="error">mdi-close-box</v-icon>
                                        </v-card-actions>
                                    </div>
                                    <h3
                                        :style="{ color: checkTargetCare === 'Achieved the Target' ? 'rgb(0, 230, 0)' : 'rgb(255, 71, 26)' }">
                                        {{ percentTimeCareTa }}
                                    </h3>
                                </div>
                            </v-card-text>
                        </v-card>
                    </div>
                </v-col>
                <!-- Main content column with the graph and data tables -->
                <v-col cols="10" class="pa-0">
                    <!-- ... (Content for loading state, graph, and data tables) -->
                    <v-card-text class="pa-1">
                        <v-sheet color="#fff">
                            <v-card-text class="pb-0">
                                <v-row>
                                    <v-col v-if="loading" cols="12">
                                        <h2 style="color:rgb(77, 77, 0);" v-if="indexA === selectedItem">
                                            {{ item.text }}
                                        </h2>
                                        <v-card flat style="background-color: #ffffff; height: 350px;">
                                            <v-progress-circular style="top:36%" :width="7" :size="65"
                                                indeterminate></v-progress-circular>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" class="py-1">
                                        <v-card-text class="pt-0">
                                            <div v-if="this.tabledisplay !== 'Targets'">
                                                <div v-for="(item, indexA) in (tabledisplay === 'Customer Complaint' ? itemdatacustomer : (tabledisplay === 'Root Cause' ? itemdatacust : itemdatarootall))"
                                                    :key="indexA">
                                                    <div v-if="!loading">
                                                        <h2 style="color:rgb(77, 77, 0);" v-if="indexA === selectedItem">
                                                            {{ item.text }}
                                                        </h2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div v-if="this.tabledisplay === 'Targets'">
                                                <h2 style="color:rgb(77, 77, 0);">
                                                    <span>
                                                        TARGETS
                                                    </span>
                                                </h2>
                                            </div>
                                            <div v-if="this.tabledisplay !== 'Targets'" class="custom-font">
                                                <canvas height="100px" id="myChart"></canvas>
                                            </div>
                                            <div v-else class="custom-font">
                                                <MyChartBar v-if="targetDate" :desserts="desserts" />
                                                <MyChartLine v-else :datasetdatatime="datasetdatatime" />
                                            </div>
                                        </v-card-text>
                                    </v-col>
                                </v-row>
                            </v-card-text>
                            <div class="px-1">
                                <v-divider style="background-color: #ffff00;"></v-divider>
                            </div>
                            <v-card-text v-if="this.tabledisplay !== 'Targets'"
                                style="background-color: rgba(255, 206, 86,0.1);">
                                <v-row>
                                    <v-col
                                        v-if="(!loading && (tabledisplay === 'Customer Complaint' || tabledisplay === 'Root Cause Report'))"
                                        cols="12" sm="7" md="7" class="px-0 py-0">
                                        <v-card-text class="px-1 pt-0 pb-1" style="color: #000000;">
                                            <h4 style="color: #b3b300;">DATA TABLE</h4>
                                            <v-simple-table dense flat fixed-header class="table-container custom-font"
                                                :height="dataset.length >= 5 ? '225px' : null"
                                                :max-height="dataset.length < 5 ? '225px' : null">
                                                <template v-slot:default>
                                                    <thead>
                                                        <tr>
                                                            <th class="text-center" style="color: #ffff00;">
                                                                Row Labels
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                Count of SERVICE
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                percentages(%)
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="item in dataset" :key="item.name"
                                                            :style="{ color: item.name === 'Other' ? '#ffff00' : '#ffff' }">
                                                            <td>{{ item.name }}</td>
                                                            <td>{{ item.value }}</td>
                                                            <td>{{ item.percentage }}</td>
                                                        </tr>
                                                        <tr style="background-color: #ffff00;">
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    {{ tablename }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    {{ tabledataall }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    100%
                                                                </h4>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </template>
                                            </v-simple-table>
                                        </v-card-text>
                                    </v-col>
                                    <v-col v-if="(!loading && tabledisplay === 'Root Cause')" cols="12" sm="7" md="7"
                                        class="px-0 py-0">
                                        <v-card-text class="px-1 pt-0 pb-1" style="color: #000000;">
                                            <h4 style="color: #b3b300;">DATA TABLE</h4>
                                            <v-simple-table dense flat fixed-header class="table-container custom-font"
                                                :height="dataset.length >= 5 ? '225px' : null"
                                                :max-height="dataset.length < 5 ? '225px' : null">
                                                <template v-slot:default>
                                                    <thead>
                                                        <tr>
                                                            <th class="text-center" style="color: #ffff00;">
                                                                Row Labels
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                Count of SERVICE GROUP
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                percentages(%)
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="item in dataset" :key="item.name">
                                                            <td>{{ item.name }}</td>
                                                            <td>{{ item.value }}</td>
                                                            <td>{{ item.percentage }}</td>
                                                        </tr>
                                                        <tr style="background-color: #ffff00;">
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    {{ tablename }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    {{ tabledataall }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    100%
                                                                </h4>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </template>
                                            </v-simple-table>
                                        </v-card-text>
                                    </v-col>
                                    <v-col cols="12" sm="5" md="5" class="px-0 py-0">
                                        <v-card-text class="px-1 pt-0 pb-1" style="color: #000000;">
                                            <h4 style="color: #b3b300;">TABLE TIME</h4>
                                            <v-simple-table dense flat fixed-header class="table-container custom-font"
                                                :height="datasetdatatime.length >= 5 ? '225px' : null"
                                                :max-height="datasetdatatime.length < 5 ? '225px' : null">
                                                <template v-slot:default>
                                                    <thead>
                                                        <tr>
                                                            <th class="text-center" style="color: #ffff00;">
                                                                Ticket/KPI
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                ≤ 20m
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                &gt; 20m
                                                            </th>
                                                            <th class="text-center" style="color:#ffff00;">
                                                                Total
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="item in datasetdatatime" :key="item.name">
                                                            <td>{{ item.name }}</td>
                                                            <td>{{ item.valuemin }}</td>
                                                            <td>{{ item.valuemax }}</td>
                                                            <td>{{ item.dataall }}</td>
                                                        </tr>
                                                        <tr style="background-color: #ffff00;">
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    percent(%)
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>

                                                                    L(20m):{{ percentTimeDoTa }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    H(20m):{{ percentTimeDo }}
                                                                </h4>
                                                            </td>
                                                            <td style="color: #000;">
                                                                <h4>
                                                                    100%
                                                                </h4>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </template>
                                            </v-simple-table>
                                        </v-card-text>
                                    </v-col>
                                </v-row>
                            </v-card-text>